<!-- saved from url=(0014)about:internet -->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8"/>
<title>ExportCollada.as</title>
<link rel="stylesheet" type="text/css" href="../../../../../../../../SourceStyles.css"/>
</head>

<body><pre><span class="ActionScriptpackage">package</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">papervision3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">io</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">exporters</span>
<span class="ActionScriptBracket/Brace">{</span>
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">flash</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Dictionary</span>;
    
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">papervision3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">TriangleMesh3D</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">papervision3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">renderables</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Triangle3D</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">papervision3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geom</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">renderables</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Vertex3D</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">papervision3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">math</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">Matrix3D</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">papervision3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">core</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">proto</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MaterialObject3D</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">papervision3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">BitmapFileMaterial</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">papervision3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">WireframeMaterial</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">papervision3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">utils</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">MaterialsList</span>;
    <span class="ActionScriptReserved">import</span> <span class="ActionScriptDefault_Text">org</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">papervision3d</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">objects</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">DisplayObject3D</span>;
    
    <span class="ActionScriptASDoc">/**
     * This class lets you export a DisplayObject3D to the Collada file format (*.dae).
     * &lt;p&gt;&lt;/p&gt;
     * 
     * @author Tim Knip
     */</span> 
    <span class="ActionScriptReserved">public</span> <span class="ActionScriptclass">class</span> <span class="ActionScriptDefault_Text">ExportCollada</span>
    <span class="ActionScriptBracket/Brace">{</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">DEFAULT_TEXTURE_DIR</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"."</span>;
        
        <span class="ActionScriptASDoc">/** Default visuals scene id and name. */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">VISUAL_SCENE_NAME</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"PapervisionScene"</span>;
        
        <span class="ActionScriptASDoc">/** Number of fraction digits to use for floats. */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">FRACTION_DIGITS</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 5;
        
        <span class="ActionScriptASDoc">/** Boolean indicatin whether to flip faces. */</span>
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">REVERSE_WINDING</span>:<span class="ActionScriptDefault_Text">Boolean</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
        
        <span class="ActionScriptASDoc">/**
         * 
         */</span> 
        <span class="ActionScriptReserved">public</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">export</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">_hasImages</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">false</span>;
            <span class="ActionScriptDefault_Text">_numImages</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">_materialToImageId</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Dictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">_numInstances</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">_numMaterials</span> <span class="ActionScriptOperator">=</span> 0;
            <span class="ActionScriptDefault_Text">_materialTargets</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Dictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">prepareMaterials</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xml</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;?xml version="1.0" encoding="utf-8"?&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;COLLADA xmlns="http://www.collada.org/2005/11/COLLADASchema" version="1.4.1"&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// export main asset element
</span>            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;asset&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;contributor&gt;'</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;author&gt;Tim Knip&lt;/author&gt;'</span><span class="ActionScriptOperator">,</span> 3<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;authoring_tool&gt;Papervision3D - ColladaExport&lt;/authoring_tool&gt;'</span><span class="ActionScriptOperator">,</span> 3<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;comments&gt;&lt;/comments&gt;'</span><span class="ActionScriptOperator">,</span> 3<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;source_data&gt;&lt;/source_data&gt;'</span><span class="ActionScriptOperator">,</span> 3<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/contributor&gt;'</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;created&gt;2008-05-07T00:05:39Z&lt;/created&gt;'</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;modified&gt;2008-05-07T00:05:39Z&lt;/modified&gt;'</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;unit meter="0.01" name="centimeter"/&gt;'</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;up_axis&gt;Y_UP&lt;/up_axis&gt;'</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/asset&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// export textures if needed
</span>            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_hasImages</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;library_images&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportImages</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/library_images&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;    
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// export materials
</span>            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;library_materials&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportMaterials</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/library_materials&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// export effects
</span>            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;library_effects&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportEffects</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/library_effects&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// export geometries
</span>            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;library_geometries&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportGeometries</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/library_geometries&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// export scenegraph
</span>            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;library_visual_scenes&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;visual_scene id="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">VISUAL_SCENE_NAME</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'" name="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">VISUAL_SCENE_NAME</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'"&gt;'</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportVisualScene</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">,</span> 3<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/visual_scene&gt;'</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/library_visual_scenes&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// export a default collada-scene
</span>            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;scene&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;instance_visual_scene url="#'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">VISUAL_SCENE_NAME</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'" /&gt;'</span><span class="ActionScriptOperator">,</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/scene&gt;'</span><span class="ActionScriptOperator">,</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/COLLADA&gt;'</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">xml</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Exports the &lt;color&gt; element.
         * 
         * @param material
         * @param indent
         * 
         * @return XML string 
         */</span> 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">exportColor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span>:<span class="ActionScriptDefault_Text">MaterialObject3D</span><span class="ActionScriptOperator">=</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">rgba</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">color</span>:<span class="ActionScriptDefault_Text">uint</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">WireframeMaterial</span> <span class="ActionScriptOperator">?</span> <span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">lineColor</span> : <span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">fillColor</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">r</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">&gt;&gt;</span> 16<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">/</span> 0xff;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">g</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">&gt;&gt;</span> 8<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">/</span> 0xff;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">b</span>:<span class="ActionScriptDefault_Text">Number</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">color</span> <span class="ActionScriptOperator">&amp;</span> 0xff<span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">/</span> 0xff;
                
                <span class="ActionScriptDefault_Text">rgba</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">r</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toFixed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FRACTION_DIGITS</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">g</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toFixed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FRACTION_DIGITS</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">b</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toFixed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FRACTION_DIGITS</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> 1.0<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">else</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">rgba</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span>0.0<span class="ActionScriptOperator">,</span> 0.0<span class="ActionScriptOperator">,</span> 0.0<span class="ActionScriptOperator">,</span> 1.0<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;color&gt;'</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">rgba</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">join</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">" "</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">'&lt;/color&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Exports the &lt;effect&gt; elements.
         * 
         * @param object
         * @param indent
         * 
         * @return XML string 
         */</span> 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">exportEffects</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xml</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">name</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materialsByName</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">material</span>:<span class="ActionScriptDefault_Text">MaterialObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materialsByName</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tgt</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_materialTargets</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptBracket/Brace">]</span>;
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">textureId</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_materialToImageId</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptBracket/Brace">]</span>;
                
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;effect id="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">tgt</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'-fx"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;profile_COMMON&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textureId</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;newparam sid="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">textureId</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'-surface"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>2<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;surface type="2D"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>3<span class="ActionScriptBracket/Brace">)</span>;    
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;init_from&gt;'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">textureId</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'&lt;/init_from&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;    
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;format&gt;A8R8G8B8&lt;/format&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;    
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/surface&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>3<span class="ActionScriptBracket/Brace">)</span>;    
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/newparam&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>2<span class="ActionScriptBracket/Brace">)</span>;    
                    
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;newparam sid="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">textureId</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'-sampler"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>2<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;sampler2D&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>3<span class="ActionScriptBracket/Brace">)</span>;    
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;source&gt;'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">textureId</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'-surface&lt;/source&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;    
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;minfilter&gt;LINEAR_MIPMAP_LINEAR&lt;/minfilter&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;magfilter&gt;LINEAR&lt;/magfilter&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/sampler2D&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>3<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/newparam&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>2<span class="ActionScriptBracket/Brace">)</span>;    
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;technique sid="common"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>2<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;phong&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>3<span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;emission&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportColor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 5<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/emission&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;ambient&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportColor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 5<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/ambient&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;diffuse&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">textureId</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;texture texture="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">textureId</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'-sampler" texcoord="TEX0"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>5<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/texture&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>5<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportColor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 5<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/diffuse&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;specular&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportColor</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">null</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 5<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/specular&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;shininess&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;float&gt;20.0&lt;/float&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>5<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/shininess&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;reflectivity&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;float&gt;20.0&lt;/float&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>5<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/reflectivity&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;transparent&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;color&gt;1 1 1 1&lt;/color&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>5<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/transparent&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;transparency&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;float&gt;1.0&lt;/float&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>5<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/transparency&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>4<span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/phong&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>3<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/technique&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>2<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/profile_COMMON&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/effect&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">child</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportEffects</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">child</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
                
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">xml</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Exports a &lt;source&gt; element with float data.
         * 
         * @param id
         * @param values
         * @param params
         * @param indent
         * 
         * @return XML String
         */</span> 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">exportFloatSource</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">id</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">values</span>:<span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">params</span>:<span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xml</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;source id="'</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">id</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">'"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">fid</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">id</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">"-array"</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">cnt</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">values</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">data</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">values</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">join</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">" "</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">line</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">'&lt;float_array id="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">fid</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'" count="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">cnt</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'"&gt;'</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">data</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">'&lt;/float_array&gt;'</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">line</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;technique_common&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">stride</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">params</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
            <span class="ActionScriptDefault_Text">cnt</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">cnt</span> <span class="ActionScriptOperator">/</span> <span class="ActionScriptDefault_Text">stride</span>;
            
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;accessor source="#'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">fid</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'" count="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">cnt</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'" stride="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">stride</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">params</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;param name="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">params</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'" type="float" /&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 3<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/accessor&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/technique_common&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/source&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">xml</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Export all geometries and child-geometries for a specific DisplayObject3D
         * 
         * @param instance
         * @param indent
         * 
         * @return XML string 
         */</span> 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">exportGeometries</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xml</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;

            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">TriangleMesh3D</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportGeometry</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span> <span class="ActionScriptReserved">as</span> <span class="ActionScriptDefault_Text">TriangleMesh3D</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">getInstanceName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"-geometry"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
                
            <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">child</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportGeometries</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">child</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
                
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">xml</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Exports a mesh's geometry as a Collada &lt;geometry&gt; element.
         * 
         * @param mesh
         * @param id
         * @param indent
         * 
         * @return XML string
         */</span> 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">exportGeometry</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">mesh</span>:<span class="ActionScriptDefault_Text">TriangleMesh3D</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">id</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xml</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;geometry id="'</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">id</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">'" name="'</span><span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">id</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">'"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tri</span>:<span class="ActionScriptDefault_Text">Triangle3D</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">v</span>:<span class="ActionScriptDefault_Text">Vertex3D</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">trianglesByMaterial</span>:<span class="ActionScriptDefault_Text">Object</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Object</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">uvs</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">vData</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">uvData</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">materialName</span>:<span class="ActionScriptDefault_Text">String</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">vindices</span>:<span class="ActionScriptDefault_Text">Dictionary</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Dictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">uvindices</span>:<span class="ActionScriptDefault_Text">Dictionary</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Dictionary</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptReserved">true</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;mesh&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">v</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">vertices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptDefault_Text">vindices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">v</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">i</span>;
                <span class="ActionScriptDefault_Text">vData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">v</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">x</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toFixed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FRACTION_DIGITS</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">vData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">v</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">y</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toFixed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FRACTION_DIGITS</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">vData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">v</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">z</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toFixed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FRACTION_DIGITS</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">faces</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">tri</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">faces</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span>;    
                
                <span class="ActionScriptDefault_Text">materialName</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">findMaterialName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptBracket/Brace">)</span>;    
                
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">trianglesByMaterial</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">materialName</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">trianglesByMaterial</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">materialName</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">trianglesByMaterial</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">materialName</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">)</span>;    
                
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">idx</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">uvs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>;
                
                <span class="ActionScriptDefault_Text">uvindices</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">tri</span> <span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">idx</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">idx</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">idx</span><span class="ActionScriptOperator">+</span>2<span class="ActionScriptBracket/Brace">]</span>;
                
                <span class="ActionScriptDefault_Text">uvs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">tri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">uv0</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">tri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">uv1</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">tri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">uv2</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>    
            
            <span class="ActionScriptComment">// build uv source-data
</span>            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">uvs</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">uvData</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">uvs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">u</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toFixed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FRACTION_DIGITS</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">uvs</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">v</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toFixed</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">FRACTION_DIGITS</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// export &lt;source&gt; elements for vertices and uvs
</span>            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportFloatSource</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">id</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"-positions"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">vData</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">"X"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">"Y"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">"Z"</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportFloatSource</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">id</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">"-texcoords"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">uvData</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptString">"S"</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">"T"</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// export &lt;vertices&gt; element
</span>            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;vertices id="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">id</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'-vertices"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;input semantic="POSITION" source="#'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">id</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'-positions" /&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 3<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/vertices&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptComment">// export a &lt;triangles&gt; element for each material used by the geometry
</span>            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">materialName</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">trianglesByMaterial</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tris</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">trianglesByMaterial</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">materialName</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">p</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">Array</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">tris</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptDefault_Text">tri</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">mesh</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">faces</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">tris</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">i</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptBracket/Brace">]</span>;
                    
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">uva</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">uvindices</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">tri</span> <span class="ActionScriptBracket/Brace">]</span>;
                    
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">REVERSE_WINDING</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">vindices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">tri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">v2</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">uva</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>; 
                        <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">vindices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">tri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">v1</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">uva</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>; 
                        <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">vindices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">tri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">v0</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">uva</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>; 
                    <span class="ActionScriptBracket/Brace">}</span>
                    <span class="ActionScriptReserved">else</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">vindices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">tri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">v0</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">uva</span><span class="ActionScriptBracket/Brace">[</span>0<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">vindices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">tri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">v1</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">uva</span><span class="ActionScriptBracket/Brace">[</span>1<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">push</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">vindices</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">tri</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">v2</span><span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">uva</span><span class="ActionScriptBracket/Brace">[</span>2<span class="ActionScriptBracket/Brace">]</span><span class="ActionScriptBracket/Brace">)</span>; 
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;triangles material="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">materialName</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'" count="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">tris</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;input semantic="VERTEX" source="#'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">id</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'-vertices" offset="0" /&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 3<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;input semantic="TEXCOORD" source="#'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">id</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'-texcoords" offset="1" set="0" /&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 3<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;p&gt;'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">p</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">join</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">" "</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'&lt;/p&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 3<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/triangles&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptComment">// all done
</span>            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/mesh&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/geometry&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">xml</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Exports the &lt;image&gt; elements.
         * 
         * @param object
         * @param indent
         * 
         * @return XML string 
         */</span> 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">exportImages</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xml</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">name</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materialsByName</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">material</span>:<span class="ActionScriptDefault_Text">MaterialObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materialsByName</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">]</span>;
                
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">BitmapFileMaterial</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">id</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"psdFileTex"</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_numImages</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">url</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">BitmapFileMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">url</span>;
                    <span class="ActionScriptDefault_Text">url</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">split</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"\\"</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">join</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"/"</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">indexOf</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"/"</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">!=</span> <span class="ActionScriptOperator">-</span>1<span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">parts</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">split</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">"/"</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">url</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">String</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">parts</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">pop</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                    
                    <span class="ActionScriptDefault_Text">url</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">DEFAULT_TEXTURE_DIR</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">"/"</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">url</span>;
                    <span class="ActionScriptDefault_Text">url</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">replace</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">/\/\//</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptString">"/"</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;image id="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">id</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'" name="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">id</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;init_from&gt;'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">url</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'&lt;/init_from&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptOperator">+</span>1<span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/image&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
                    
                    <span class="ActionScriptDefault_Text">_materialToImageId</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">id</span>;
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">child</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportImages</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">child</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
                
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">xml</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Exports the &lt;material&gt; elements.
         * 
         * @param object
         * @param indent
         * 
         * @return XML string 
         */</span> 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">exportMaterials</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xml</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">name</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materialsByName</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">material</span>:<span class="ActionScriptDefault_Text">MaterialObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materialsByName</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">]</span>;
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tgt</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_materialTargets</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptBracket/Brace">]</span>;
                 
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;material id="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">tgt</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'" name="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">tgt</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;instance_effect url="#'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">tgt</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'-fx" /&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/material&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">child</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportMaterials</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">child</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;
                
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">xml</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Exports a &lt;matrix&gt; element.
         * 
         * @param matrix
         * @param indent
         * 
         * @return XML string 
         */</span> 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">exportMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">matrix</span>:<span class="ActionScriptDefault_Text">Matrix3D</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">data</span>:<span class="ActionScriptDefault_Text">Array</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptBracket/Brace">[</span>
                <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n11</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n12</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n13</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n14</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n21</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n22</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n23</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n24</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n31</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n32</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n33</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n34</span><span class="ActionScriptOperator">,</span>
                <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n41</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n42</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n43</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">matrix</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">n44</span>
            <span class="ActionScriptBracket/Brace">]</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;matrix&gt;'</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">data</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">join</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">" "</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">'&lt;/matrix&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;    
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * Exports a &lt;visual_scene&gt; element.
         * 
         * @param object
         * @param indent
         * 
         * @return XML string 
         */</span> 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">exportVisualScene</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span>:<span class="ActionScriptDefault_Text">int</span><span class="ActionScriptOperator">=</span>0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>                
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">id</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">getInstanceName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span><span class="ActionScriptBracket/Brace">)</span>;

            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">xml</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;node id="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">id</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'" name="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">id</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;    
            
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportMatrix</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">transform</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">TriangleMesh3D</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;instance_geometry url="#'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">id</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'-geometry"&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;bind_material&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;technique_common&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 3<span class="ActionScriptBracket/Brace">)</span>;
                
                <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">materialName</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materialsByName</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">material</span>:<span class="ActionScriptDefault_Text">MaterialObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materialsByName</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">materialName</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">tgt</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">_materialTargets</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptBracket/Brace">]</span>;
                    <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;instance_material symbol="'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">materialName</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'" target="#'</span><span class="ActionScriptOperator">+</span><span class="ActionScriptDefault_Text">tgt</span><span class="ActionScriptOperator">+</span><span class="ActionScriptString">'" /&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 4<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptBracket/Brace">}</span>
                
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/technique_common&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 3<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/bind_material&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 2<span class="ActionScriptBracket/Brace">)</span>;
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/instance_geometry&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">child</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">exportVisualScene</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">child</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span> <span class="ActionScriptOperator">+</span> 1<span class="ActionScriptBracket/Brace">)</span>;
            
            <span class="ActionScriptDefault_Text">xml</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptString">'&lt;/node&gt;'</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span><span class="ActionScriptBracket/Brace">)</span>;    
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">xml</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * 
         */</span> 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">getInstanceName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span> 
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">length</span> <span class="ActionScriptOperator">&gt;</span> 2<span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span>;
            <span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"Node"</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">_numInstances</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">instance</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">name</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * 
         */</span> 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">prepareMaterials</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptReserved">void</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span> <span class="ActionScriptOperator">||</span> <span class="ActionScriptReserved">new</span> <span class="ActionScriptDefault_Text">MaterialsList</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span>;    
            
            <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span> <span class="ActionScriptOperator">&amp;&amp;</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">faces</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">triangle</span>:<span class="ActionScriptDefault_Text">Triangle3D</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">geometry</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">faces</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptBracket/Brace">{</span>
                    <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">name</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">findMaterialName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">triangle</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptBracket/Brace">)</span>;
                    <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptOperator">!</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptBracket/Brace">{</span>
                        <span class="ActionScriptDefault_Text">name</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">"Material"</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">_numMaterials</span>;
                        <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">addMaterial</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">triangle</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">)</span>;
                        <span class="ActionScriptDefault_Text">_numMaterials</span><span class="ActionScriptOperator">++</span>;
                    <span class="ActionScriptBracket/Brace">}</span>
                <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">materialName</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materialsByName</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">material</span>:<span class="ActionScriptDefault_Text">MaterialObject3D</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materials</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materialsByName</span><span class="ActionScriptBracket/Brace">[</span> <span class="ActionScriptDefault_Text">materialName</span> <span class="ActionScriptBracket/Brace">]</span>;
                
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">material</span> <span class="ActionScriptReserved">is</span> <span class="ActionScriptDefault_Text">BitmapFileMaterial</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptDefault_Text">_hasImages</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptReserved">true</span>;
    
                <span class="ActionScriptDefault_Text">_materialTargets</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">material</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptDefault_Text">materialName</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">toLowerCase</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptBracket/Brace">)</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">"-target"</span>;    
            <span class="ActionScriptBracket/Brace">}</span>
            
            <span class="ActionScriptReserved">for each</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">child</span>:<span class="ActionScriptDefault_Text">DisplayObject3D</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">object</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">children</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">prepareMaterials</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">child</span><span class="ActionScriptBracket/Brace">)</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptASDoc">/**
         * 
         */</span> 
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">findMaterialName</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">find</span>:<span class="ActionScriptDefault_Text">MaterialObject3D</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">list</span>:<span class="ActionScriptDefault_Text">MaterialsList</span><span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">name</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptReserved">in</span> <span class="ActionScriptDefault_Text">list</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materialsByName</span><span class="ActionScriptBracket/Brace">)</span>
            <span class="ActionScriptBracket/Brace">{</span>
                <span class="ActionScriptReserved">if</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">list</span><span class="ActionScriptOperator">.</span><span class="ActionScriptDefault_Text">materialsByName</span><span class="ActionScriptBracket/Brace">[</span><span class="ActionScriptDefault_Text">name</span><span class="ActionScriptBracket/Brace">]</span> <span class="ActionScriptOperator">===</span> <span class="ActionScriptDefault_Text">find</span><span class="ActionScriptBracket/Brace">)</span>
                    <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">name</span>;
            <span class="ActionScriptBracket/Brace">}</span>
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptReserved">null</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptfunction">function</span> <span class="ActionScriptDefault_Text">printLine</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptDefault_Text">str</span>:<span class="ActionScriptDefault_Text">String</span><span class="ActionScriptOperator">,</span> <span class="ActionScriptDefault_Text">indent</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0<span class="ActionScriptBracket/Brace">)</span>:<span class="ActionScriptDefault_Text">String</span>
        <span class="ActionScriptBracket/Brace">{</span>
            <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">s</span>:<span class="ActionScriptDefault_Text">String</span> <span class="ActionScriptOperator">=</span> <span class="ActionScriptString">""</span>;
            <span class="ActionScriptReserved">for</span><span class="ActionScriptBracket/Brace">(</span><span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">i</span>:<span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0; <span class="ActionScriptDefault_Text">i</span> <span class="ActionScriptOperator">&lt;</span> <span class="ActionScriptDefault_Text">indent</span>; <span class="ActionScriptDefault_Text">i</span><span class="ActionScriptOperator">++</span><span class="ActionScriptBracket/Brace">)</span>
                <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">+=</span> <span class="ActionScriptString">"\t"</span>;
            <span class="ActionScriptReserved">return</span> <span class="ActionScriptDefault_Text">s</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptDefault_Text">str</span> <span class="ActionScriptOperator">+</span> <span class="ActionScriptString">"\n"</span>;
        <span class="ActionScriptBracket/Brace">}</span>
        
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_numInstances</span>        : <span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_numMaterials</span>        : <span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_materialTargets</span>        : <span class="ActionScriptDefault_Text">Dictionary</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_hasImages</span>            : <span class="ActionScriptDefault_Text">Boolean</span>;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_numImages</span>            : <span class="ActionScriptDefault_Text">int</span> <span class="ActionScriptOperator">=</span> 0;
        <span class="ActionScriptReserved">private</span> <span class="ActionScriptReserved">static</span> <span class="ActionScriptvar">var</span> <span class="ActionScriptDefault_Text">_materialToImageId</span>    : <span class="ActionScriptDefault_Text">Dictionary</span>;
    <span class="ActionScriptBracket/Brace">}</span>
<span class="ActionScriptBracket/Brace">}</span></pre></body>
</html>
